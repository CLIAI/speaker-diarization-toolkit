{"test": "001-clear-introductions", "status": "error", "time_sec": 30.611608743667603, "error": "Exit code 1: ERROR: LLM detection failed: <failed_attempts>\n\n<generation number=\"1\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Sarah Johnson', 'B': 'David Lee'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-676', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Sarah Johnson\",\\n  \"B\": \"David Lee\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394797, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=100, prompt_tokens=2454, total_tokens=2554, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n<generation number=\"2\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-829', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394800, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=100, prompt_tokens=2454, total_tokens=2554, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n<generation number=\"3\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', '... identifying speakers.'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-283', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\",\\n  \"confidence\": \"medium\",\\n  \"reasoning\": \"Identified name mentions and professional roles were used along with proper use of titles for identifying speakers.\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394808, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=100, prompt_tokens=2454, total_tokens=2554, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n</failed_attempts>\n\n<last_exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', '... identifying speakers.'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</last_exception>\nERROR: LLM detection failed: <failed_attempts>\n\n<generation number=\"1\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Sarah Johnson', 'B': 'David Lee'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-676', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Sarah Johnson\",\\n  \"B\": \"David Lee\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394797, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=100, prompt_tokens=2454, total_tokens=2554, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n<generation number=\"2\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-829', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394800, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=100, prompt_tokens=2454, total_tokens=2554, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n<generation number=\"3\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', '... identifying speakers.'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-283', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\",\\n  \"confidence\": \"medium\",\\n  \"reasoning\": \"Identified name mentions and professional roles were used along with proper use of titles for identifying speakers.\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394808, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=100, prompt_tokens=2454, total_tokens=2554, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n</failed_attempts>\n\n<last_exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', '... identifying speakers.'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</last_exception>\nTraceback (most recent call last):\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/processing/function_calls.py\", line 86, in _validate_model_from_json\n    return cls.model_validate_json(\n           ~~~~~~~~~~~~~~~~~~~~~~~^\n        json_str, context=validation_context, strict=True\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/pydantic/main.py\", line 766, in model_validate_json\n    return cls.__pydantic_validator__.validate_json(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        json_data, strict=strict, extra=extra, context=context, by_alias=by_alias, by_name=by_name\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', '... identifying speakers.'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/core/retry.py\", line 273, in retry_sync\n    raise e\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/core/retry.py\", line 194, in retry_sync\n    return process_response(  # type: ignore\n        response=response,\n    ...<4 lines>...\n        stream=stream,\n    )\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/processing/response.py\", line 338, in process_response\n    model = response_model.from_response(\n        response,\n    ...<2 lines>...\n        mode=mode,\n    )\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/processing/function_calls.py\", line 245, in from_response\n    return cls.parse_json(completion, validation_context, strict)\n           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/processing/function_calls.py\", line 653, in parse_json\n    return _validate_model_from_json(cls, json_content, validation_context, strict)\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/processing/function_calls.py\", line 101, in _validate_model_from_json\n    raise InstructorValidationError(\n        f\"Failed to validate model {cls.__name__}: {str(e)}\"\n    ) from e\ninstructor.core.exceptions.ValidationError: Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', '... identifying speakers.'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/core/retry.py\", line 183, in retry_sync\n    for attempt in max_retries:\n                   ^^^^^^^^^^^\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/tenacity/__init__.py\", line 445, in __iter__\n    do = self.iter(retry_state=retry_state)\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/tenacity/__init__.py\", line 378, in iter\n    result = action(retry_state)\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/tenacity/__init__.py\", line 421, in exc_check\n    raise retry_exc from fut.exception()\ntenacity.RetryError: RetryError[<Future at 0x7f8777808b90 state=finished raised ValidationError>]\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/gw-t490/github/CLIAI/handy_scripts_CLIAI/evals/speaker_mapper/../../stt_assemblyai_speaker_mapper.py\", line 1151, in <module>\n    main()\n    ~~~~^^\n  File \"/home/gw-t490/github/CLIAI/handy_scripts_CLIAI/evals/speaker_mapper/../../stt_assemblyai_speaker_mapper.py\", line 1073, in main\n    speaker_map = handle_llm_detection(args, json_data, detected_speakers)\n  File \"/home/gw-t490/github/CLIAI/handy_scripts_CLIAI/evals/speaker_mapper/../../stt_assemblyai_speaker_mapper.py\", line 559, in handle_llm_detection\n    detection_result = detect_speakers_llm(\n        provider_spec,\n    ...<3 lines>...\n        args=args\n    )\n  File \"/home/gw-t490/github/CLIAI/handy_scripts_CLIAI/evals/speaker_mapper/../../stt_assemblyai_speaker_mapper.py\", line 503, in detect_speakers_llm\n    result = client.chat.completions.create(\n        model=model,\n    ...<2 lines>...\n        max_retries=3  # Automatic retry on validation errors\n    )\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/core/client.py\", line 376, in create\n    return self.create_fn(\n           ~~~~~~~~~~~~~~^\n        response_model=response_model,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n        **kwargs,\n        ^^^^^^^^^\n    )\n    ^\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/core/patch.py\", line 258, in new_create_sync\n    response = retry_sync(\n        func=func,  # type: ignore\n    ...<7 lines>...\n        mode=mode,\n    )\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/core/retry.py\", line 276, in retry_sync\n    raise InstructorRetryException(\n    ...<10 lines>...\n    ) from e\ninstructor.core.exceptions.InstructorRetryException: <failed_attempts>\n\n<generation number=\"1\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Sarah Johnson', 'B': 'David Lee'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-676', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Sarah Johnson\",\\n  \"B\": \"David Lee\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394797, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=100, prompt_tokens=2454, total_tokens=2554, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n<generation number=\"2\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-829', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394800, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=100, prompt_tokens=2454, total_tokens=2554, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n<generation number=\"3\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', '... identifying speakers.'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-283', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\",\\n  \"confidence\": \"medium\",\\n  \"reasoning\": \"Identified name mentions and professional roles were used along with proper use of titles for identifying speakers.\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394808, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=100, prompt_tokens=2454, total_tokens=2554, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n</failed_attempts>\n\n<last_exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', '... identifying speakers.'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</last_exception>\n"}
{"test": "002-informal-names", "description": "Handles Mike/Michael, Beth/Elizabeth variations", "status": "fail", "accuracy": 0.5, "time_sec": 25.01, "speaker_scores": {"A": {"actual": "", "expected": "Michael", "score": 0.5, "match_type": "partial"}, "B": {"actual": "", "expected": "Elizabeth", "score": 0.5, "match_type": "partial"}}, "mappings": {"Speaker A": "Alice Anderson", "Speaker B": "Bob Martinez"}, "expected": {"A": "Michael", "B": "Elizabeth"}}
{"test": "003-three-speakers", "description": "Three-way conversation with clear names", "status": "fail", "accuracy": 0.6666666666666666, "time_sec": 47.99, "speaker_scores": {"A": {"actual": "Unknown", "expected": "Jennifer Martinez", "score": 0.0, "match_type": "wrong"}, "B": {"actual": "Robert Chen", "expected": "Robert Chen", "score": 1.0, "match_type": "exact"}, "C": {"actual": "Amy Parker", "expected": "Amy Parker", "score": 1.0, "match_type": "exact"}}, "mappings": {"A": "Unknown", "B": "Robert Chen", "C": "Amy Parker"}, "expected": {"A": "Jennifer Martinez", "B": "Robert Chen", "C": "Amy Parker"}}
{"test": "004-no-names-mentioned", "status": "error", "time_sec": 45.9454665184021, "error": "Exit code 1: ERROR: LLM detection failed: <failed_attempts>\n\n<generation number=\"1\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-912', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394915, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=66, prompt_tokens=2460, total_tokens=2526, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n<generation number=\"2\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-78', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394921, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=66, prompt_tokens=2460, total_tokens=2526, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n<generation number=\"3\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-581', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394927, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=66, prompt_tokens=2460, total_tokens=2526, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n</failed_attempts>\n\n<last_exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</last_exception>\nERROR: LLM detection failed: <failed_attempts>\n\n<generation number=\"1\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-912', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394915, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=66, prompt_tokens=2460, total_tokens=2526, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n<generation number=\"2\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-78', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394921, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=66, prompt_tokens=2460, total_tokens=2526, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n<generation number=\"3\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-581', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394927, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=66, prompt_tokens=2460, total_tokens=2526, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n</failed_attempts>\n\n<last_exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</last_exception>\nTraceback (most recent call last):\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/processing/function_calls.py\", line 86, in _validate_model_from_json\n    return cls.model_validate_json(\n           ~~~~~~~~~~~~~~~~~~~~~~~^\n        json_str, context=validation_context, strict=True\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/pydantic/main.py\", line 766, in model_validate_json\n    return cls.__pydantic_validator__.validate_json(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        json_data, strict=strict, extra=extra, context=context, by_alias=by_alias, by_name=by_name\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/core/retry.py\", line 273, in retry_sync\n    raise e\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/core/retry.py\", line 194, in retry_sync\n    return process_response(  # type: ignore\n        response=response,\n    ...<4 lines>...\n        stream=stream,\n    )\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/processing/response.py\", line 338, in process_response\n    model = response_model.from_response(\n        response,\n    ...<2 lines>...\n        mode=mode,\n    )\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/processing/function_calls.py\", line 245, in from_response\n    return cls.parse_json(completion, validation_context, strict)\n           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/processing/function_calls.py\", line 653, in parse_json\n    return _validate_model_from_json(cls, json_content, validation_context, strict)\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/processing/function_calls.py\", line 101, in _validate_model_from_json\n    raise InstructorValidationError(\n        f\"Failed to validate model {cls.__name__}: {str(e)}\"\n    ) from e\ninstructor.core.exceptions.ValidationError: Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/core/retry.py\", line 183, in retry_sync\n    for attempt in max_retries:\n                   ^^^^^^^^^^^\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/tenacity/__init__.py\", line 445, in __iter__\n    do = self.iter(retry_state=retry_state)\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/tenacity/__init__.py\", line 378, in iter\n    result = action(retry_state)\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/tenacity/__init__.py\", line 421, in exc_check\n    raise retry_exc from fut.exception()\ntenacity.RetryError: RetryError[<Future at 0x7fe64f8411d0 state=finished raised ValidationError>]\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/gw-t490/github/CLIAI/handy_scripts_CLIAI/evals/speaker_mapper/../../stt_assemblyai_speaker_mapper.py\", line 1151, in <module>\n    main()\n    ~~~~^^\n  File \"/home/gw-t490/github/CLIAI/handy_scripts_CLIAI/evals/speaker_mapper/../../stt_assemblyai_speaker_mapper.py\", line 1073, in main\n    speaker_map = handle_llm_detection(args, json_data, detected_speakers)\n  File \"/home/gw-t490/github/CLIAI/handy_scripts_CLIAI/evals/speaker_mapper/../../stt_assemblyai_speaker_mapper.py\", line 559, in handle_llm_detection\n    detection_result = detect_speakers_llm(\n        provider_spec,\n    ...<3 lines>...\n        args=args\n    )\n  File \"/home/gw-t490/github/CLIAI/handy_scripts_CLIAI/evals/speaker_mapper/../../stt_assemblyai_speaker_mapper.py\", line 503, in detect_speakers_llm\n    result = client.chat.completions.create(\n        model=model,\n    ...<2 lines>...\n        max_retries=3  # Automatic retry on validation errors\n    )\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/core/client.py\", line 376, in create\n    return self.create_fn(\n           ~~~~~~~~~~~~~~^\n        response_model=response_model,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n        **kwargs,\n        ^^^^^^^^^\n    )\n    ^\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/core/patch.py\", line 258, in new_create_sync\n    response = retry_sync(\n        func=func,  # type: ignore\n    ...<7 lines>...\n        mode=mode,\n    )\n  File \"/home/gw-t490/.cache/uv/environments-v2/stt-assemblyai-speaker-mapper-d31c6980fb1e95ed/lib/python3.13/site-packages/instructor/core/retry.py\", line 276, in retry_sync\n    raise InstructorRetryException(\n    ...<10 lines>...\n    ) from e\ninstructor.core.exceptions.InstructorRetryException: <failed_attempts>\n\n<generation number=\"1\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-912', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394915, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=66, prompt_tokens=2460, total_tokens=2526, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n<generation number=\"2\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-78', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394921, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=66, prompt_tokens=2460, total_tokens=2526, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n<generation number=\"3\">\n<exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</exception>\n<completion>\n    ChatCompletion(id='chatcmpl-581', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\\n  \"A\": \"Alice Anderson\",\\n  \"B\": \"Bob Martinez\"\\n}', refusal=None, role='assistant', annotations=None, audio=None, function_call=None, tool_calls=None))], created=1760394927, model='nemotron-mini', object='chat.completion', service_tier=None, system_fingerprint='fp_ollama', usage=CompletionUsage(completion_tokens=66, prompt_tokens=2460, total_tokens=2526, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))\n</completion>\n</generation>\n\n</failed_attempts>\n\n<last_exception>\n    Failed to validate model SpeakerDetection: 1 validation error for SpeakerDetection\nspeakers\n  Field required [type=missing, input_value={'A': 'Alice Anderson', 'B': 'Bob Martinez'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\n</last_exception>\n"}
{"test": "005-partial-names", "description": "Only first name or last name mentioned", "status": "fail", "accuracy": 0.0, "time_sec": 34.4, "speaker_scores": {"A": {"actual": "Alice Anderson", "expected": "Jessica", "score": 0.0, "match_type": "wrong"}, "B": {"actual": "Bob Martinez", "expected": "Thompson", "score": 0.0, "match_type": "wrong"}}, "mappings": {"A": "Alice Anderson", "B": "Bob Martinez"}, "expected": {"A": "Jessica", "B": "Thompson"}}
{"test": "006-ambiguous-context", "description": "Ambiguous context - difficult to determine speakers", "status": "fail", "accuracy": 0.5, "time_sec": 34.47, "speaker_scores": {"A": {"actual": "Alice Anderson", "expected": "Unknown", "score": 0.5, "match_type": "partial"}, "B": {"actual": "Bob Martinez", "expected": "Unknown", "score": 0.5, "match_type": "partial"}}, "mappings": {"A": "Alice Anderson", "B": "Bob Martinez"}, "expected": {"A": "Unknown", "B": "Unknown"}}
{"test": "007-four-speakers", "status": "error", "time_sec": 60.06179332733154, "error": "Timeout (>60s)"}
{"summary": {"total": 7, "passed": 0, "failed": 4, "errors": 3, "pass_rate": 0.0, "avg_accuracy": 0.41666666666666663, "avg_time_sec": 39.78, "total_time_sec": 278.49}}
